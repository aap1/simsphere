program test_intpol
  use simsphere_mod
  implicit none

  real,dimension(50) :: ug_exp, vg_exp, ugd_exp, vgd_exp

  NTRP = 10.0
  VGS = 10.0
  UGS = 10.0

  VD = 1.0
  UD = 1.0

  VGD(NTRP) = 1.0
  UGD(NTRP) = 1.0

  ug_exp = (/9.18181801,8.36363602,7.54545498,6.72727299,5.90909100, &
             5.09090948,4.27272749,3.45454597,2.63636398,1.81818199, &
             1.00000000,0.181818962,-0.636363029,-1.45454502,-2.27272701, &
             -3.09090805,-3.90909004,-4.72727203,-5.54545403,-6.36363602, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000/)

  vg_exp = (/9.18181801,8.36363602,7.54545498,6.72727299,5.90909100, &
             5.09090948,4.27272749,3.45454597,2.63636398,1.81818199, &
             1.00000000,0.181818962,-0.636363029,-1.45454502,-2.27272701, &
             -3.09090805,-3.90909004,-4.72727203,-5.54545403,-6.36363602, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
             0.00000000,0.00000000,0.00000000,0.00000000,0.00000000/)

  ugd_exp = (/9.57142830,7.42857170,5.28571463,3.14285755,1.00000000, &
              1.00000000,1.00000000,1.00000000,1.00000000,1.00000000, &
              1.00000000,1.00000000,1.00000000,1.00000000,1.00000000, &
              1.00000000,1.00000000,1.00000000,1.00000000,1.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000/)

  vgd_exp = (/9.57142830,7.42857170,5.28571463,3.14285755,1.00000000, &
              1.00000000,1.00000000,1.00000000,1.00000000,1.00000000, &
              1.00000000,1.00000000,1.00000000,1.00000000,1.00000000, &
              1.00000000,1.00000000,1.00000000,1.00000000,1.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000, &
              0.00000000,0.00000000,0.00000000,0.00000000,0.00000000/)

  call intpol

  if (all(ug_exp == ug)) write(*,*) 'ug matches expected'
  if (all(vg_exp == vg)) write(*,*) 'vg matches expected'
  if (all(ugd_exp == ugd)) write(*,*) 'ugd matches expected'
  if (all(vgd_exp == vgd)) write(*,*) 'vgd matches expected'
    

end program test_intpol
